package no.kommune.oslo.methodology

import no.kommune.oslo.model.RiskTreatment
import no.kommune.oslo.model.SeverityLevels.*
import no.kommune.oslo.model.Threat
import no.kommune.oslo.model.Vulnerability
import no.kommune.oslo.model.VulnerabilityTypes.TECHNICAL
import org.apache.logging.log4j.LogManager
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class SimpleVulnerabilityScoreCalculationTest {
    private val logger = LogManager.getLogger(javaClass)

    @Test
    fun `Expect calculated vulnerability NONE without any exploiting threats`() {
        var exploitedByThreatList: List<Threat> = emptyList()
        var riskTreatmentsList: List<RiskTreatment> = emptyList()

        val vulnerability = Vulnerability(
                vulnerabilityType = TECHNICAL,
                vulnerabilityDescription = "Test vulnerability 1",
                vulnerabilityPotential = HIGH, exploitedByThreats = emptyList(), riskTreatments = emptyList()
//                exploitedByThreats = RiskTestFactory.createModerateThreatList(),
//                riskTreatments = RiskTestFactory.createMixedRiskTreatmentList()
        )
        val valScore = SimpleVulnerabilityScoreCalculation.calculateVulnerability(
                vulnerability = vulnerability,
                threatPresence = EXTREME,
                riskTreatment = LOW
        )
        assertThat(valScore).isEqualTo(NONE)
        logger.debug("valScore: $valScore")
    }
}